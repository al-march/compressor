import{c as T,g as p,a as I,i as $,b as n,S as L,F as G,t as f,d as V,e as S,r as M,f as P,h as z,j as Q,M as H,k as J}from"./chunks/web.ae784fa2.js";import{R as K,C as O,I as j,a as U}from"./chunks/ResultStats.57a64ac1.js";import{C as W,i as X,d as Y}from"./chunks/download.dbe2a9b7.js";import{C as ee,D as te,A as le}from"./chunks/CompressDropZone.a38cff9f.js";import{T as se,S as ne}from"./chunks/Scale.3b9758ee.js";/* empty css                              */import"./chunks/ImageCompareSlider.f5435aba.js";import"./chunks/Loader.6d3e4a0d.js";import"./chunks/store.9db19ba7.js";const ie=f('<div class="text-center result-table-cell th title">\u0418\u043C\u044F</div>'),ae=f('<div class="text-center result-table-cell th before">\u0414\u043E</div>'),re=f('<div class="text-center result-table-cell th status">\u0421\u0442\u0430\u0442\u0443\u0441</div>'),oe=f('<div class="text-center result-table-cell th after">\u041F\u043E\u0441\u043B\u0435</div>'),ce=f('<div class="text-center result-table-cell th actions">\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u044F</div>'),ue=f('<div class="overflow-x-auto rounded py-1"><div class="result-table"><!#><!/><!#><!/></div><!#><!/></div>'),ge=e=>{const[c,h]=T(!1),[g,r]=T();return(()=>{const t=p(ue),d=t.firstChild,b=d.firstChild,[x,C]=I(b.nextSibling),y=x.nextSibling,[R,i]=I(y.nextSibling),a=d.nextSibling,[o,u]=I(a.nextSibling);return $(d,n(L,{get when(){return e.images.length},get children(){return[p(ie),p(ae),p(re),p(oe),p(ce)]}}),x,C),$(d,n(se,{onBeforeEnter:l=>l.style.height="0",onAfterEnter:l=>l.style.height=l.scrollHeight+"px",onEnter:(l,v)=>{l.animate([{opacity:0,height:0},{opacity:1,height:l.scrollHeight+"px"}],{duration:200,easing:"cubic-bezier(0.1, -0.3, 0.2, 0)"}).finished.then(v)},onExit:(l,v)=>{l.animate([{opacity:1,height:l.scrollHeight+"px"},{opacity:0,height:0}],{duration:100,easing:"cubic-bezier(0.1, -0.3, 0.2, 0)"}).finished.then(v)},get children(){return n(L,{get when(){return e.images.length},get fallback(){return[]},get children(){return n(G,{get each(){return e.images},children:l=>n(K,{image:l,get onCompressed(){return e.onImageCompress},get onRemove(){return e.onImageRemove},onCompare:()=>{r(l),h(!0)}})})}})}}),R,i),$(t,n(O,{get show(){return c()},get image(){return g()},onClose:()=>h(!1)}),o,u),t})()},de=f('<div class="form-control w-full"><label class="label"><span class="label-text">\u041A\u0430\u0447\u0435\u0441\u0442\u0432\u043E</span><span class="label-text-alt">\u043E\u0442 20 - 100%</span></label><div class="flex gap-4"><input type="range" min="20" max="100" class="range range-sm range-primary"><span></span></div></div>'),me=f('<div class="h-72 flex items-center justify-center"><article class="p-10 w-full h-full flex-1 flex flex-col"><!#><!/><section class="w-full flex flex-row gap-2"><div class="form-control max-w-full w-1/2"><label class="label"><span class="label-text">\u0428\u0438\u0440\u0438\u043D\u0430</span><span class="label-text-alt">*\u0434\u043B\u044F \u0432\u0441\u0435\u0445</span></label><input type="number" placeholder="\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0447\u0438\u0441\u043B\u043E" class="input input-sm input-bordered w-full"></div><div class="form-control max-w-full w-1/2"><label class="label"><span class="label-text">\u0412\u044B\u0441\u043E\u0442\u0430</span><span class="label-text-alt">*\u0434\u043B\u044F \u0432\u0441\u0435\u0445</span></label><input type="number" placeholder="\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0447\u0438\u0441\u043B\u043E" class="input input-sm input-bordered w-full"></div></section><section class="w-full flex flex-row gap-2"><div class="form-control max-w-full w-1/2"><label class="label"><span class="label-text">\u041F\u0440\u0435\u0444\u0438\u043A\u0441</span></label><input type="text" placeholder="\u041F\u0440\u0435\u0444\u0438\u043A\u0441-" class="input input-sm input-bordered w-full"></div><div class="form-control max-w-full w-1/2"><label class="label"><span class="label-text">\u0421\u0443\u0444\u0444\u0438\u043A\u0441</span></label><input type="text" placeholder="-\u0421\u0443\u0444\u0438\u043A\u0441" class="input input-sm input-bordered w-full"></div></section></article></div>'),pe=e=>{const[c,h]=T((e.value||.8)*100);function g(r){const t=Number(r.target.value);h(t),e.onChange?.(t)}return(()=>{const r=p(de),t=r.firstChild,d=t.nextSibling,b=d.firstChild,x=b.nextSibling;return b.$$input=g,$(x,c),S(()=>b.value=c()),M(),r})()},fe=()=>{const e=j,c={quality:e.state.settings.quality,prefix:e.state.settings.prefix||"",suffix:e.state.settings.suffix||"",width:e.state.settings.width,height:e.state.settings.height};return(()=>{const h=p(me),g=h.firstChild,r=g.firstChild,[t,d]=I(r.nextSibling),b=t.nextSibling,x=b.firstChild,C=x.firstChild,y=C.nextSibling,R=x.nextSibling,i=R.firstChild,a=i.nextSibling,o=b.nextSibling,u=o.firstChild,l=u.firstChild,v=l.nextSibling,_=u.nextSibling,k=_.firstChild,A=k.nextSibling;return $(g,n(pe,{get value(){return c.quality},onChange:m=>e.mergeSettings({quality:m/100})}),t,d),y.$$input=m=>e.mergeSettings({width:Number(m.currentTarget.value)}),a.$$input=m=>e.mergeSettings({height:Number(m.currentTarget.value)}),v.$$input=m=>e.mergeSettings({prefix:m.currentTarget.value}),A.$$input=m=>e.mergeSettings({suffix:m.currentTarget.value}),S(()=>y.value=c.width),S(()=>a.value=c.height),S(()=>v.value=c.prefix),S(()=>A.value=c.suffix),M(),h})()};V(["input"]);const be=f('<div class="transition-all"></div>'),$e=f('<footer class="flex gap-4 items-center justify-between p-2 rounded"><button class="btn btn-error btn-outline btn-xs">\u041E\u0447\u0438\u0441\u0442\u0438\u0442\u044C</button><!#><!/><button class="btn btn-primary btn-outline btn-xs">\u0421\u043A\u0430\u0447\u0430\u0442\u044C</button></footer>'),he=f('<section class="flex flex-1 flex-col gap-4 p-2"><div class="flex flex-col gap-6 max-w-2xl w-full mx-auto rounded"><div class="shadow"><header class="flex items-center"><span class="flex-1"></span></header></div><div class="shadow rounded p-2 result-border"><header class="w-full flex gap-1"><div class="flex-1"></div><button type="button" class="btn btn-sm">\u0421\u0436\u0430\u0442\u0438\u0435</button><button type="button" class="btn btn-sm">\u041D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0438</button></header><!#><!/></div><div></div><div></div></div></section>'),Ee=()=>{const e=j,[c,h]=T(!1),[g,r]=T("compress"),t=P(()=>Array.from(e.state.images));function d(i){const a=[];for(let o of i)if(b(o.type)){const u=new W(o);a.push(u)}else console.warn(`image type [${o.type}] not access`);e.setImages(a),r("settings")}function b(i){return le.some(a=>i.includes(a))}function x(){e.reset(),r("compress")}function C(){const i=t().map(a=>{const o=a.compress;if(o){const u=X.addPrefixAndSuffix(o.name,e.state.settings.prefix,e.state.settings.suffix);return new File([o],u)}}).filter(a=>a instanceof File);Y.zip(i)}function y(i){e.compressImage(i)}function R(i){e.removeImage(i),e.state.images.size||r("compress")}return(()=>{const i=p(he),a=i.firstChild,o=a.firstChild,u=o.nextSibling,l=u.firstChild,v=l.firstChild,_=v.nextSibling,k=_.nextSibling,A=l.nextSibling,[m,Z]=I(A.nextSibling),D=u.nextSibling,q=D.nextSibling;return _.$$click=()=>r("compress"),k.$$click=()=>r("settings"),$(u,n(ne,{mode:"outin",get children(){return n(Q,{get children(){return[n(H,{get when(){return g()==="compress"},get children(){return n(ee,{onDropFiles:d})}}),n(H,{get when(){return g()==="settings"},get children(){return n(fe,{})}})]}})}}),m,Z),$(D,n(te,{onEnteredChange:h,onDropFiles:d,get children(){const s=p(be);return $(s,n(ge,{get images(){return t()},onImageCompress:y,onImageRemove:R,onLoadAll:C})),S(w=>J(s,{"opacity-50 scale-95":c()},w)),s}})),$(q,n(L,{get when(){return t().length},get children(){const s=p($e),w=s.firstChild,F=w.nextSibling,[E,N]=I(F.nextSibling),B=E.nextSibling;return w.$$click=x,$(s,n(U,{get images(){return t()}}),E,N),B.$$click=C,M(),s}})),S(s=>{const w=g()==="compress",F=g()==="settings",E=t().length&&"shadow"||"",N=t().length&&"shadow"||"";return w!==s._v$&&_.classList.toggle("btn-primary",s._v$=w),F!==s._v$2&&k.classList.toggle("btn-primary",s._v$2=F),E!==s._v$3&&z(D,s._v$3=E),N!==s._v$4&&z(q,s._v$4=N),s},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),M(),i})()};V(["click"]);export{Ee as ImageCompressor};
