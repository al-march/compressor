import{c as $,q as N,f as R,u as D,m as j,v as q,w as M,b as X}from"./web.fe524d5d.js";class F{initial;compress;previewSrc;get percentDif(){return this.compress?Math.ceil(100-100/this.initial.size*this.compress.size):0}constructor(i){this.initial=i}async createPreviewSrc(){return this.compress&&(this.previewSrc=await F.createSrc(this.compress)),this.previewSrc}static createSrc(i){return new Promise((n,l)=>{const f=new FileReader;f.readAsDataURL(i),f.onload=w=>{const E=w.target?.result;E?n(String(E)):l("cannot parse image")}})}}function Y(e){const i=[];for(let n=0;n<e.length;n++){const l=e[n];if(l instanceof File){const f=new F(l);i.push(f)}}return i}function k(e){const i=[];for(const n of e)n instanceof File&&i.push(n);return i}function z(e){const i=e.split("").reverse(),n=i.findIndex(f=>f==="."),l=i.splice(0,n+1);return{name:i.reverse().join(""),ext:l.reverse().join("")}}function G(e,i="",n=""){const{name:l,ext:f}=z(e);return`${i}${l}${n}${f}`}const U=Object.assign({},{fileListToCompressImages:Y,listToImages:k,addPrefixAndSuffix:G,sliceExt:z});function B(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}const H=e=>{let i,n=!0;const[l,f]=$(),[w,E]=$(),T=N(()=>e.children),{onBeforeEnter:y,onEnter:h,onAfterEnter:S,onBeforeExit:g,onExit:A,onAfterExit:c}=e,u=R(()=>{const t=e.name||"s";return{enterActiveClass:e.enterActiveClass||t+"-enter-active",enterClass:e.enterClass||t+"-enter",enterToClass:e.enterToClass||t+"-enter-to",exitActiveClass:e.exitActiveClass||t+"-exit-active",exitClass:e.exitClass||t+"-exit",exitToClass:e.exitToClass||t+"-exit-to"}});function o(t,a){if(!n||e.appear){let m=function(C){t&&(!C||C.target===t)&&(t.removeEventListener("transitionend",m),t.removeEventListener("animationend",m),t.classList.remove(...d),t.classList.remove(...x),M(()=>{l()!==t&&f(t),w()===t&&E(void 0)}),S&&S(t),e.mode==="inout"&&r(t,a))};const v=u().enterClass.split(" "),d=u().enterActiveClass.split(" "),x=u().enterToClass.split(" ");y&&y(t),t.classList.add(...v),t.classList.add(...d),B(()=>{t.classList.remove(...v),t.classList.add(...x),h&&h(t,()=>m()),(!h||h.length<2)&&(t.addEventListener("transitionend",m),t.addEventListener("animationend",m))})}a&&!e.mode?E(t):f(t)}function r(t,a){const v=u().exitClass.split(" "),d=u().exitActiveClass.split(" "),x=u().exitToClass.split(" ");if(!a.parentNode)return m();g&&g(a),a.classList.add(...v),a.classList.add(...d),B(()=>{a.classList.remove(...v),a.classList.add(...x)}),A&&A(a,()=>m()),(!A||A.length<2)&&(a.addEventListener("transitionend",m),a.addEventListener("animationend",m));function m(C){(!C||C.target===a)&&(a.removeEventListener("transitionend",m),a.removeEventListener("animationend",m),a.classList.remove(...d),a.classList.remove(...x),l()===a&&f(void 0),c&&c(a),e.mode==="outin"&&o(t,a))}}return D(t=>{for(i=T();typeof i=="function";)i=i();return q(()=>(i&&i!==t&&(e.mode!=="outin"?o(i,t):n&&f(i)),t&&t!==i&&e.mode!=="inout"&&r(i,t),n=!1,i))}),[l,w]};function P(e){const{top:i,bottom:n,left:l,right:f,width:w,height:E}=e.getBoundingClientRect(),T=e.parentNode.getBoundingClientRect();return{top:i-T.top,bottom:n,left:l-T.left,right:f,width:w,height:E}}const J=e=>{const i=N(()=>e.children),n=R(()=>{const c=e.name||"s";return{enterActiveClass:e.enterActiveClass||c+"-enter-active",enterClass:e.enterClass||c+"-enter",enterToClass:e.enterToClass||c+"-enter-to",exitActiveClass:e.exitActiveClass||c+"-exit-active",exitClass:e.exitClass||c+"-exit",exitToClass:e.exitToClass||c+"-exit-to",moveClass:e.moveClass||c+"-move"}}),{onBeforeEnter:l,onEnter:f,onAfterEnter:w,onBeforeExit:E,onExit:T,onAfterExit:y}=e,[h,S]=$();let g=[],A=!0;return D(()=>{const c=i(),u=[...c],o=new Set(c),r=new Set(g),t=n().enterClass.split(" "),a=n().enterActiveClass.split(" "),v=n().enterToClass.split(" "),d=n().exitClass.split(" "),x=n().exitActiveClass.split(" "),m=n().exitToClass.split(" ");for(let C=0;C<c.length;C++){const s=c[C];if(!A&&!r.has(s)){let L=function(b){s&&(!b||b.target===s)&&(s.removeEventListener("transitionend",L),s.removeEventListener("animationend",L),s.classList.remove(...a),s.classList.remove(...v),w&&w(s))};l&&l(s),s.classList.add(...t),s.classList.add(...a),B(()=>{s.classList.remove(...t),s.classList.add(...v),f&&f(s,()=>L()),(!f||f.length<2)&&(s.addEventListener("transitionend",L),s.addEventListener("animationend",L))})}}for(let C=0;C<g.length;C++){const s=g[C];if(!o.has(s)&&s.parentNode){let L=function(b){(!b||b.target===s)&&(s.removeEventListener("transitionend",L),s.removeEventListener("animationend",L),s.classList.remove(...x),s.classList.remove(...m),y&&y(s),g=g.filter(I=>I!==s),S(g))};u.splice(C,0,s),E&&E(s),s.classList.add(...d),s.classList.add(...x),B(()=>{s.classList.remove(...d),s.classList.add(...m)}),T&&T(s,()=>L()),(!T||T.length<2)&&(s.addEventListener("transitionend",L),s.addEventListener("animationend",L))}}g=u,S(u)}),j(c=>{const u=h();return u.forEach(o=>{let r;(r=c.get(o))?r.new&&(r.new=!1,r.newPos=P(o)):c.set(o,r={pos:P(o),new:!A}),r.new&&o.addEventListener("transitionend",()=>{r.new=!1,o.parentNode&&(r.newPos=P(o))},{once:!0}),r.newPos&&(r.pos=r.newPos),r.newPos=P(o)}),A?(A=!1,c):(u.forEach(o=>{const r=c.get(o),t=r.pos,a=r.newPos,v=t.left-a.left,d=t.top-a.top;if(v||d){r.moved=!0;const x=o.style;x.transform=`translate(${v}px,${d}px)`,x.transitionDuration="0s"}}),document.body.offsetHeight,u.forEach(o=>{const r=c.get(o);if(r.moved){let v=function(d){d&&d.target!==o||!o.parentNode||(!d||/transform$/.test(d.propertyName))&&(o.removeEventListener("transitionend",v),o.classList.remove(...a))};r.moved=!1;const t=o.style,a=n().moveClass.split(" ");o.classList.add(...a),t.transform=t.transitionDuration="",o.addEventListener("transitionend",v)}}),c)},new Map),h},K=e=>{const i=()=>{e.onExit?.()};return X(H,{get appear(){return e.appear},get mode(){return e.mode},onBeforeEnter:n=>n.style.opacity="0",onEnter:async(n,l)=>{await n.animate?.([{opacity:0,transform:"scale(0.8) translateX(-5px) translateY(20px)"},{opacity:1,transform:"scale(1) translateX(0) translateY(0)"}],{duration:160,easing:"cubic-bezier(0.55, 0, 0.55, 0.2)"}).finished,l()},onAfterEnter:n=>n.style.opacity="1",onExit:async(n,l)=>{await n.animate?.([{opacity:1,transform:"scale(1)"},{opacity:0,transform:"scale(0.90)"}],{duration:120,easing:"cubic-bezier(0.55, 0, 0.55, 0.2)"}).finished,i(),l()},get children(){return e.children}})};export{F as C,K as S,J as T,H as a,U as i};
