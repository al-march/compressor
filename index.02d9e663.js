import{c as T,g as d,a as S,i as f,b as n,S as j,F as K,t as m,d as H,e as k,r as A,s as O,f as U,m as W,u as X,h as Y,j as B,k as ee,M as Z,l as te}from"./chunks/web.1f0c9ab8.js";import{R as le,C as se,I as G,a as ne}from"./chunks/ResultStats.29587618.js";import{C as ie,i as ae,d as re}from"./chunks/download.dbe2a9b7.js";import{C as oe,D as ce,A as ue}from"./chunks/CompressDropZone.07920fb6.js";import{T as ge,S as de}from"./chunks/Scale.46a37a8d.js";/* empty css                              */import"./chunks/ImageCompareSlider.7ea4f812.js";import"./chunks/Loader.8d5d67cf.js";import"./chunks/store.9ae76bba.js";const me=m('<div class="text-center result-table-cell th title">\u0418\u043C\u044F</div>'),pe=m('<div class="text-center result-table-cell th before">\u0414\u043E</div>'),fe=m('<div class="text-center result-table-cell th status">\u0421\u0442\u0430\u0442\u0443\u0441</div>'),$e=m('<div class="text-center result-table-cell th after">\u041F\u043E\u0441\u043B\u0435</div>'),be=m('<div class="text-center result-table-cell th actions">\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u044F</div>'),he=m('<div class="overflow-x-auto rounded py-1"><div class="result-table"><!#><!/><!#><!/></div><!#><!/></div>'),xe=e=>{const[u,h]=T(!1),[o,a]=T();return(()=>{const t=d(he),g=t.firstChild,$=g.firstChild,[l,_]=S($.nextSibling),v=l.nextSibling,[D,r]=S(v.nextSibling),c=g.nextSibling,[p,b]=S(c.nextSibling);return f(g,n(j,{get when(){return e.images.length},get children(){return[d(me),d(pe),d(fe),d($e),d(be)]}}),l,_),f(g,n(ge,{onBeforeEnter:i=>i.style.height="0",onAfterEnter:i=>i.style.height=i.scrollHeight+"px",onEnter:(i,w)=>{i.animate([{opacity:0,height:0},{opacity:1,height:i.scrollHeight+"px"}],{duration:200,easing:"cubic-bezier(0.1, -0.3, 0.2, 0)"}).finished.then(w)},onExit:(i,w)=>{i.animate([{opacity:1,height:i.scrollHeight+"px"},{opacity:0,height:0}],{duration:100,easing:"cubic-bezier(0.1, -0.3, 0.2, 0)"}).finished.then(w)},get children(){return n(j,{get when(){return e.images.length},get fallback(){return[]},get children(){return n(K,{get each(){return e.images},children:i=>n(le,{image:i,get onCompressed(){return e.onImageCompress},get onRemove(){return e.onImageRemove},onCompare:()=>{a(i),h(!0)}})})}})}}),D,r),f(t,n(se,{get show(){return u()},get image(){return o()},onClose:()=>h(!1)}),p,b),t})()},_e=m('<div class="form-control w-full"><label class="label"><span class="label-text">\u041A\u0430\u0447\u0435\u0441\u0442\u0432\u043E</span><span class="label-text-alt">\u043E\u0442 20 - 100%</span></label><div class="flex gap-4"><input type="range" min="20" max="100" class="range range-sm range-primary"><span></span></div></div>'),ve=m('<div class="h-72 flex items-center justify-center"><article class="p-10 w-full h-full flex-1 flex flex-col"><!#><!/><section class="w-full flex flex-row gap-2"><div class="form-control max-w-full w-1/2"><label class="label"><span class="label-text">\u0428\u0438\u0440\u0438\u043D\u0430</span><span class="label-text-alt">*\u0434\u043B\u044F \u0432\u0441\u0435\u0445</span></label><input type="number" placeholder="\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0447\u0438\u0441\u043B\u043E" class="input input-sm input-bordered w-full"></div><div class="form-control max-w-full w-1/2"><label class="label"><span class="label-text">\u0412\u044B\u0441\u043E\u0442\u0430</span><span class="label-text-alt">*\u0434\u043B\u044F \u0432\u0441\u0435\u0445</span></label><input type="number" placeholder="\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0447\u0438\u0441\u043B\u043E" class="input input-sm input-bordered w-full"></div></section><section class="w-full flex flex-row gap-2"><div class="form-control max-w-full w-1/2"><label class="label"><span class="label-text">\u041F\u0440\u0435\u0444\u0438\u043A\u0441</span></label><input type="text" placeholder="\u041F\u0440\u0435\u0444\u0438\u043A\u0441-" class="input input-sm input-bordered w-full"></div><div class="form-control max-w-full w-1/2"><label class="label"><span class="label-text">\u0421\u0443\u0444\u0444\u0438\u043A\u0441</span></label><input type="text" placeholder="-\u0421\u0443\u0444\u0438\u043A\u0441" class="input input-sm input-bordered w-full"></div></section></article></div>'),Se=e=>{const[u,h]=T((e.value||.8)*100);function o(a){const t=Number(a.target.value);h(t),e.onChange?.(t)}return(()=>{const a=d(_e),t=a.firstChild,g=t.nextSibling,$=g.firstChild,l=$.nextSibling;return $.$$input=o,f(l,u),k(()=>$.value=u()),A(),a})()},we=()=>{const e=G,u={quality:e.state.settings.quality,prefix:e.state.settings.prefix||"",suffix:e.state.settings.suffix||"",width:e.state.settings.width,height:e.state.settings.height};return(()=>{const h=d(ve),o=h.firstChild,a=o.firstChild,[t,g]=S(a.nextSibling),$=t.nextSibling,l=$.firstChild,_=l.firstChild,v=_.nextSibling,D=l.nextSibling,r=D.firstChild,c=r.nextSibling,p=$.nextSibling,b=p.firstChild,i=b.firstChild,w=i.nextSibling,C=b.nextSibling,N=C.firstChild,M=N.nextSibling;return f(o,n(Se,{get value(){return u.quality},onChange:x=>e.mergeSettings({quality:x/100})}),t,g),v.$$input=x=>e.mergeSettings({width:Number(x.currentTarget.value)}),c.$$input=x=>e.mergeSettings({height:Number(x.currentTarget.value)}),w.$$input=x=>e.mergeSettings({prefix:x.currentTarget.value}),M.$$input=x=>e.mergeSettings({suffix:x.currentTarget.value}),k(()=>v.value=u.width),k(()=>c.value=u.height),k(()=>w.value=u.prefix),k(()=>M.value=u.suffix),A(),h})()};H(["input"]);const Ce=m('<button class="btn"></button>'),ye=m('<input type="file" multiple hidden>'),Ie=e=>{const[u,h]=T(),[o,a]=O(e,["class","classList","onClick"]);function t(){u()?.click()}function g(l){const _=l.target,v=_.files;v&&$(v),_.value=""}function $(l){e.onDropFiles?.(l)}return[(()=>{const l=d(Ce);return l.$$click=t,U(l,W({get classList(){return{[o.class||""]:!!o.class,...o.classList}}},a),!1,!1),A(),l})(),(()=>{const l=d(ye);return l.addEventListener("change",g),X(h,l),l})()]};H(["click"]);const Re=m('<div class="w-full flex items-center justify-center"></div>'),ke=m('<div class="transition-all"><!#><!/><!#><!/></div>'),Ee=m('<footer class="flex gap-4 items-center justify-between p-2 rounded"><button class="btn btn-error btn-outline btn-xs">\u041E\u0447\u0438\u0441\u0442\u0438\u0442\u044C</button><!#><!/><button class="btn btn-primary btn-outline btn-xs">\u0421\u043A\u0430\u0447\u0430\u0442\u044C (<!#><!/>)</button></footer>'),Fe=m('<section class="flex flex-1 flex-col gap-4 p-2"><div class="flex flex-col gap-6 max-w-2xl w-full mx-auto rounded"><div class="shadow"><header class="flex items-center"><span class="flex-1"></span></header></div><div class="shadow rounded p-2 result-border"><header class="w-full flex gap-1"><div class="flex-1"></div><button type="button" class="btn btn-sm">\u0421\u0436\u0430\u0442\u0438\u0435</button><button type="button" class="btn btn-sm">\u041D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0438</button></header><!#><!/></div><div></div><div></div></div></section>'),He=()=>{const e=G,[u,h]=T(!1),[o,a]=T("compress"),t=Y(()=>Array.from(e.state.images));function g(r){const c=[];for(let p of r)if($(p.type)){const b=new ie(p);c.push(b)}else console.warn(`image type [${p.type}] not access`);e.setImages(c),a("settings")}function $(r){return ue.some(c=>r.includes(c))}function l(){e.reset(),a("compress")}function _(){const r=t().map(c=>{const p=c.compress;if(p){const b=ae.addPrefixAndSuffix(p.name,e.state.settings.prefix,e.state.settings.suffix);return new File([p],b)}}).filter(c=>c instanceof File);re.zip(r)}function v(r){e.compressImage(r)}function D(r){e.removeImage(r),e.state.images.size||a("compress")}return(()=>{const r=d(Fe),c=r.firstChild,p=c.firstChild,b=p.nextSibling,i=b.firstChild,w=i.firstChild,C=w.nextSibling,N=C.nextSibling,M=i.nextSibling,[x,Q]=S(M.nextSibling),q=b.nextSibling,V=q.nextSibling;return C.$$click=()=>a("compress"),N.$$click=()=>a("settings"),f(b,n(de,{mode:"outin",get children(){return n(ee,{get children(){return[n(Z,{get when(){return o()==="compress"},get children(){return n(oe,{onDropFiles:g})}}),n(Z,{get when(){return o()==="settings"},get children(){return n(we,{})}})]}})}}),x,Q),f(q,n(ce,{onEnteredChange:h,onDropFiles:g,get children(){const s=d(ke),y=s.firstChild,[I,R]=S(y.nextSibling),E=I.nextSibling,[L,z]=S(E.nextSibling);return f(s,n(xe,{get images(){return t()},onImageCompress:v,onImageRemove:D,onLoadAll:_}),I,R),f(s,n(j,{get when(){return t().length},get children(){const F=d(Re);return f(F,n(Ie,{class:"btn-sm btn-outline mt-4",onDropFiles:g,children:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0435\u0449\u0435"})),F}}),L,z),k(F=>te(s,{"opacity-50 scale-95":u()},F)),s}})),f(V,n(j,{get when(){return t().length},get children(){const s=d(Ee),y=s.firstChild,I=y.nextSibling,[R,E]=S(I.nextSibling),L=R.nextSibling,z=L.firstChild,F=z.nextSibling,[P,J]=S(F.nextSibling);return P.nextSibling,y.$$click=l,f(s,n(ne,{get images(){return t()}}),R,E),L.$$click=_,f(L,()=>t().length,P,J),A(),s}})),k(s=>{const y=o()==="compress",I=o()==="settings",R=t().length&&"shadow"||"",E=t().length&&"shadow"||"";return y!==s._v$&&C.classList.toggle("btn-primary",s._v$=y),I!==s._v$2&&N.classList.toggle("btn-primary",s._v$2=I),R!==s._v$3&&B(q,s._v$3=R),E!==s._v$4&&B(V,s._v$4=E),s},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),A(),r})()};H(["click"]);export{He as ImageCompressor};
